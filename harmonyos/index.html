<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#00ff00">
    <title>Harmony File Bridge</title>
    <!-- Load Tailwind CSS for modern, responsive utilities -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Bootstrap Icons for file icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
    <style>
        /* Custom styles to incorporate the primary color and mobile-first design */
        :root {
            --primary-color: #00ff00; /* Vibrant Green */
            --bg-dark: #1f2937;
            --text-light: #f3f4f6;
            --card-bg: #374151;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-dark);
            color: var(--text-light);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow-x: hidden;
        }

        /* Mobile-friendly container */
        .app-container {
            max-width: 600px;
            margin: auto;
            width: 95%;
            padding: 1rem 0;
        }

        .primary-text {
            color: var(--primary-color);
        }

        .primary-bg {
            background-color: var(--primary-color);
        }

        .primary-border {
            border-color: var(--primary-color);
        }

        .file-item {
            background-color: var(--card-bg);
            transition: background-color 0.15s;
            cursor: pointer;
        }

        .file-item:hover {
            background-color: #4b5563;
        }

        .file-item.selected {
            background-color: #4c6d53; /* Darker shade of green mixed with grey */
            border-left: 4px solid var(--primary-color);
        }

        .action-button {
            padding: 0.75rem 1.5rem;
            font-weight: 600;
            border-radius: 9999px;
            transition: transform 0.1s, opacity 0.1s;
        }

        .action-button:active {
            transform: scale(0.98);
        }

        /* Customize scrollbar for a darker theme */
        .file-list-container::-webkit-scrollbar {
            width: 8px;
        }

        .file-list-container::-webkit-scrollbar-thumb {
            background-color: var(--primary-color);
            border-radius: 10px;
        }
        .file-list-container::-webkit-scrollbar-track {
            background: #2d3748;
        }
    </style>
</head>
<body>

    <div class="app-container">
        <!-- Header / Connection Status Card -->
        <div id="status-card" class="bg-gray-800 p-4 rounded-xl shadow-lg mb-4 primary-border border-2">
            <h1 class="text-xl font-bold primary-text">Harmony File Bridge</h1>
            <div class="text-sm mt-2">
                <p>Status: <span id="connection-status" class="font-semibold text-green-400">Connected</span></p>
                <p>Device: <span id="device-name" class="text-gray-300">HUAWEI MatePro 2025</span></p>
                <p>Current Path: <span id="current-path" class="text-gray-300">/storage/emulated/0/</span></p>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="flex justify-between space-x-2 mb-4">
            <button class="action-button primary-bg text-gray-900 shadow-md flex-1" onclick="uploadFiles()">
                <i class="bi bi-cloud-upload mr-2"></i>Upload
            </button>
            <button class="action-button bg-gray-600 text-white shadow-md flex-1" onclick="downloadSelected()">
                <i class="bi bi-cloud-download mr-2"></i>Download (0)
            </button>
            <button class="action-button bg-red-600 text-white shadow-md w-12" onclick="deleteSelected()" title="Delete Selected">
                <i class="bi bi-trash"></i>
            </button>
        </div>

        <!-- File List Panel (Remote Device) -->
        <div class="bg-gray-800 rounded-xl shadow-lg">
            <div class="p-3 border-b border-gray-700 flex justify-between items-center">
                <h2 class="font-semibold text-lg text-gray-100">Remote Files</h2>
                <button onclick="goUpDirectory()" class="text-sm text-gray-400 hover:text-white transition">
                    <i class="bi bi-arrow-up-circle-fill mr-1"></i> Up
                </button>
            </div>
            
            <!-- File List Container -->
            <div id="file-list" class="file-list-container max-h-[50vh] overflow-y-scroll divide-y divide-gray-700">
                <!-- File items will be injected here by JavaScript -->
            </div>
        </div>

        <!-- Transfer Log/Info Area -->
        <div class="bg-gray-800 p-4 rounded-xl shadow-lg mt-4">
            <h2 class="font-semibold text-sm text-gray-400 mb-2">Transfer Activity</h2>
            <div id="log-area" class="text-xs text-gray-500 max-h-24 overflow-y-auto">
                <p>[10:55:01] <span class="primary-text">INFO:</span> Connection established to device via SuperLink...</p>
                <p>[10:55:02] Listing remote file directory...</p>
            </div>
        </div>

        <!-- Custom Modal for Alerts/Confirmations -->
        <div id="app-modal" class="fixed inset-0 bg-black bg-opacity-70 hidden items-center justify-center p-4 z-50" onclick="hideModal()">
            <div class="bg-gray-800 p-6 rounded-xl shadow-2xl max-w-sm w-full transform transition-all duration-300 scale-95" onclick="event.stopPropagation()">
                <h3 id="modal-title" class="text-xl font-bold mb-3 primary-text">Alert</h3>
                <p id="modal-message" class="text-gray-300 mb-4"></p>
                <div class="flex justify-end space-x-3">
                    <button id="modal-cancel" class="action-button bg-gray-600 text-white hidden" onclick="confirmAction(false)">Cancel</button>
                    <button id="modal-ok" class="action-button primary-bg text-gray-900" onclick="confirmAction(true)">OK</button>
                </div>
            </div>
        </div>

    </div>

    <script>
        // Global State
        const KB = 1024;
        const MB = 1024 * KB;
        const GB = 1024 * MB;
        let selectedFiles = new Set();
        let confirmationCallback = null;
        
        // Mock File Data (Includes files > 10MB)
        const mockFiles = [
            { name: "DCIM/", type: "folder", size: 0, date: "2025-10-20 14:30" },
            { name: "Music/", type: "folder", size: 0, date: "2025-08-01 07:00" },
            { name: "Documents/", type: "folder", size: 0, date: "2025-09-15 09:10" },
            { name: "Videos/", type: "folder", size: 0, date: "2025-10-18 20:05" },
            { name: "LargeVideo_4K.mp4", type: "file", size: 450 * MB, date: "2025-10-21 10:00" }, // 450MB (>10MB)
            { name: "SystemBackup.zip", type: "file", size: 12.5 * MB, date: "2025-10-19 11:30" }, // 12.5MB (>10MB)
            { name: "HolidayPics.jpg", type: "file", size: 5 * MB, date: "2025-10-21 09:00" }, // 5MB
            { name: "config.txt", type: "file", size: 10 * KB, date: "2025-10-21 09:00" }, // 10KB
        ];

        // Utility to format bytes into readable size
        function formatBytes(bytes) {
            if (bytes === 0) return '';
            const sizes = ['B', 'KB', 'MB', 'GB', 'TB'];
            const i = parseInt(Math.floor(Math.log(bytes) / Math.log(1024)));
            return (bytes / Math.pow(1024, i)).toFixed(i > 0 ? 1 : 0) + ' ' + sizes[i];
        }

        // --- UI Functions ---

        function getFileIcon(type) {
            switch (type) {
                case 'folder':
                    return '<i class="bi bi-folder-fill text-yellow-400 text-xl"></i>';
                case 'file':
                    if (mockFiles.find(f => f.type === 'file' && f.name.includes('.mp4'))) {
                        return '<i class="bi bi-file-earmark-play-fill text-red-500 text-xl"></i>';
                    }
                    if (mockFiles.find(f => f.type === 'file' && f.name.includes('.zip'))) {
                        return '<i class="bi bi-file-earmark-zip-fill text-blue-400 text-xl"></i>';
                    }
                    if (mockFiles.find(f => f.type === 'file' && f.name.includes('.jpg'))) {
                        return '<i class="bi bi-file-earmark-image-fill text-purple-400 text-xl"></i>';
                    }
                    return '<i class="bi bi-file-earmark text-gray-400 text-xl"></i>';
                default:
                    return '<i class="bi bi-file-earmark text-gray-400 text-xl"></i>';
            }
        }

        function renderFileList() {
            const listContainer = document.getElementById('file-list');
            listContainer.innerHTML = '';
            
            mockFiles.forEach((file, index) => {
                const isSelected = selectedFiles.has(index);
                const isLarge = file.size > 10 * MB;

                const fileElement = document.createElement('div');
                fileElement.classList = `file-item p-3 flex items-center justify-between transition duration-150 ${isSelected ? 'selected' : ''}`;
                fileElement.setAttribute('data-index', index);
                
                // Content structure: Icon + Name + Info
                fileElement.innerHTML = `
                    <div class="flex items-center flex-1 min-w-0">
                        <div class="mr-3">${getFileIcon(file.type)}</div>
                        <div class="min-w-0">
                            <span class="block font-medium truncate">${file.name}</span>
                            <span class="text-xs text-gray-400">${file.date}</span>
                        </div>
                    </div>
                    <div class="flex-shrink-0 text-right ml-4">
                        <span class="block font-semibold ${isLarge ? 'primary-text' : 'text-gray-300'}">${formatBytes(file.size)}</span>
                    </div>
                `;

                fileElement.addEventListener('click', (event) => {
                    // Prevent propagation if the click was on the item itself (for better mobile touch)
                    toggleSelection(index);
                });

                listContainer.appendChild(fileElement);
            });

            updateActionButtons();
        }

        function toggleSelection(index) {
            const fileElement = document.querySelector(`[data-index="${index}"]`);
            if (selectedFiles.has(index)) {
                selectedFiles.delete(index);
                fileElement.classList.remove('selected');
            } else {
                selectedFiles.add(index);
                fileElement.classList.add('selected');
            }
            updateActionButtons();
        }

        function updateActionButtons() {
            const count = selectedFiles.size;
            const downloadButton = document.querySelector('button[onclick="downloadSelected()"]');
            downloadButton.textContent = `Download (${count})`;
            downloadButton.classList.toggle('primary-bg', count > 0);
            downloadButton.classList.toggle('bg-gray-600', count === 0);
            downloadButton.classList.toggle('text-gray-900', count > 0);
        }

        // --- Action Handlers (Mocked) ---

        function addLog(message, type = 'INFO') {
            const logArea = document.getElementById('log-area');
            const now = new Date().toLocaleTimeString('en-US', {hour12: false});
            const colorClass = type === 'ERROR' ? 'text-red-400' : (type === 'SUCCESS' ? 'text-green-400' : 'primary-text');
            const logEntry = document.createElement('p');
            logEntry.innerHTML = `[${now}] <span class="${colorClass}">${type}:</span> ${message}`;
            logArea.prepend(logEntry); // Add to top
            // Auto scroll to top to see latest logs
            logArea.scrollTop = 0;
        }

        function uploadFiles() {
            showModal('Upload File', 'Initiating SuperLink File Upload... (Simulation only)');
            addLog('Ready for file upload...', 'INFO');
        }

        function downloadSelected() {
            const count = selectedFiles.size;
            if (count === 0) {
                showModal('No Files Selected', 'Please select one or more files to start the download.');
                return;
            }

            const filesToDownload = Array.from(selectedFiles).map(i => mockFiles[i].name);
            const totalSize = Array.from(selectedFiles).reduce((sum, i) => sum + mockFiles[i].size, 0);

            showModal(
                'Confirm Download',
                `Are you sure you want to download ${count} items (Total size: ${formatBytes(totalSize)})?`,
                true,
                () => {
                    addLog(`Starting download of ${count} files...`, 'INFO');
                    filesToDownload.forEach(name => {
                        addLog(`Download started: ${name}`, 'SUCCESS');
                    });
                    selectedFiles.clear();
                    renderFileList();
                }
            );
        }

        function deleteSelected() {
            const count = selectedFiles.size;
            if (count === 0) {
                showModal('No Files Selected', 'Please select one or more files to delete.');
                return;
            }

            showModal(
                'Confirm Deletion',
                `WARNING: You are about to delete ${count} selected items. This action cannot be undone. Proceed?`,
                true,
                () => {
                    const filesToDelete = Array.from(selectedFiles).map(i => mockFiles[i].name);
                    filesToDelete.forEach(name => {
                        addLog(`File deleted: ${name}`, 'SUCCESS');
                    });
                    
                    // Simple removal simulation (in a real app, this would update mockFiles)
                    addLog(`${count} items deleted successfully from the remote device.`, 'SUCCESS');
                    selectedFiles.clear();
                    renderFileList();
                }
            );
        }

        function goUpDirectory() {
            showModal('Navigation', 'Moving to parent directory... (Simulation only)');
            document.getElementById('current-path').textContent = '/storage/';
            addLog('Navigated up to: /storage/', 'INFO');
        }


        // --- Custom Modal/Alert Implementation ---

        function showModal(title, message, isConfirmation = false, onConfirm = null) {
            document.getElementById('modal-title').textContent = title;
            document.getElementById('modal-message').textContent = message;
            
            const modalCancel = document.getElementById('modal-cancel');
            const modalOk = document.getElementById('modal-ok');

            if (isConfirmation) {
                modalCancel.classList.remove('hidden');
                modalOk.textContent = 'Confirm';
                modalOk.classList.add('bg-red-500');
                modalOk.classList.remove('primary-bg');
                confirmationCallback = onConfirm;
            } else {
                modalCancel.classList.add('hidden');
                modalOk.textContent = 'OK';
                modalOk.classList.add('primary-bg');
                modalOk.classList.remove('bg-red-500');
                confirmationCallback = null;
            }

            document.getElementById('app-modal').classList.remove('hidden');
            document.getElementById('app-modal').classList.add('flex');
        }

        function hideModal() {
            document.getElementById('app-modal').classList.add('hidden');
            document.getElementById('app-modal').classList.remove('flex');
        }

        function confirmAction(isConfirmed) {
            if (isConfirmed && confirmationCallback) {
                confirmationCallback();
            }
            hideModal();
        }

        // --- Initialization ---

        window.onload = function() {
            renderFileList();
        };

        // For Firebase/Auth initialization (required structure, though not used for persistence here)
        // const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        // const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};
        // console.log("App ID:", appId);

    </script>
</body>
</html>

  
